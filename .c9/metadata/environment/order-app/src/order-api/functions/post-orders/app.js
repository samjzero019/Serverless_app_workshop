{"filter":false,"title":"app.js","tooltip":"/order-app/src/order-api/functions/post-orders/app.js","undoManager":{"mark":0,"position":0,"stack":[[{"start":{"row":0,"column":0},"end":{"row":59,"column":0},"action":"insert","lines":["// Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.","// SPDX-License-Identifier: MIT-0","","const dynamodb = require('aws-sdk/clients/dynamodb');","const docClient = new dynamodb.DocumentClient();","const uuid = require('node-uuid');","","const tableName = process.env.ORDER_TABLE;","const DEFAULT_ORDER_STATUS = \"PENDING\" // Default Order Status will be written to DynamoDB","","// The function returns current date","const getCurrentDate = () => {","    let date_ob = new Date();","    let date = (\"0\" + date_ob.getDate()).slice(-2);","    let month = (\"0\" + (date_ob.getMonth() + 1)).slice(-2);","    let year = date_ob.getFullYear();","    let hours = date_ob.getHours();","    let minutes = date_ob.getMinutes();","    let seconds = date_ob.getSeconds();","    ","    return year + \"-\" + month + \"-\" + date + \"T\" + hours + \":\" + minutes + \":\" + seconds;","}","","exports.postOrders = async (event) => {","    let formattedDateNow = getCurrentDate();","    const { body } = event;   // It destructures the body payload from event. ","    let parsedBody = JSON.parse(body); // It parses the JSON payload to java script object ","    ","    // The item contains fully order Item. ","    let item = {","        user_id : \"static_user\",   ","        id: uuid.v4(),             ","        name: parsedBody.name, ","        restaurantId: parsedBody.restaurantId, ","        quantity: parsedBody.quantity,","        createdAt: formattedDateNow.toString(),","        orderStatus: DEFAULT_ORDER_STATUS,","    }","    ","    let params = {","        TableName : tableName,","        Item: item","    }; ","","    // We use 'put' operator to put item to Dynamodb.","    try {","        const data = await docClient.put(params).promise()","        console.log(\"Success for putting Item\")","        console.log(data)","    } catch (err) {","        console.log(\"Failure\", err.message)","    }","    const response = {","      statusCode: 200,","      body: JSON.stringify(item)","","    };","    return response;","}",""],"id":1}]]},"ace":{"folds":[],"scrolltop":258,"scrollleft":0,"selection":{"start":{"row":50,"column":28},"end":{"row":51,"column":5},"isBackwards":true},"options":{"guessTabSize":true,"useWrapMode":false,"wrapToView":true},"firstLineState":{"row":17,"state":"start","mode":"ace/mode/javascript"}},"timestamp":1674647577185,"hash":"d49548ffc98ae78b949e9d938f96a193fead4e7b"}